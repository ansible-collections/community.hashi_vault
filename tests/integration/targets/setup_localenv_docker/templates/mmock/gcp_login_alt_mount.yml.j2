# Copyright (c) 2024 Michael Woodham (woodham@google.com)
# GNU General Public License v3.0+ (see LICENSES/GPL-3.0-or-later.txt or https://www.gnu.org/licenses/gpl-3.0.txt)
# SPDX-License-Identifier: GPL-3.0-or-later
#jinja2:variable_start_string:'[%', variable_end_string:'%]'
---
request:
  method: POST|PUT
  path: "/v1/auth/gcp-alt/login"
control:
  priority: 10
response:
  statusCode: 200
  headers:
    Content-Type:
      - application/json
  body: >-
    {
        "request_id": "{{fake.UUID}}",
        "lease_id": "",
        "lease_duration": 0,
        "renewable": false,
        "data": null,
        "warnings": null,
        "auth": {
            "client_token": "s.{{fake.CharactersN(24)}}",
            "accessor": "{{fake.CharactersN(24)}}",
            "policies": [
                "default",
                "gcp-alt-sample-policy"
            ],
            "metadata": {
                "project_id": "{{fake.digitsN(12)}}",
                "role": "my-role",
                "service_account_email": "dev1@{{fake.digitsN(12)}}.iam.gserviceaccount.com",
                "service_account_id": "{{fake.digitsN(12)}}"
            },
            "lease_duration": 1800,
            "renewable": true
        }
    }